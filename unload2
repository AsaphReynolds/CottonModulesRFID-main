import math

def get_weight_lbs(mA, tilt_x_deg, tilt_y_deg, scale_capacity_lbs):
    """
    Calculate true weight in pounds, corrected for tilt.
    
    Parameters:
        mA (float): Output from Rice Lake SCT-10 (4.0 to 20.0 mA)
        tilt_x_deg (float): Inclinometer X-axis tilt in degrees (±45)
        tilt_y_deg (float): Inclinometer Y-axis tilt in degrees (±45)
        scale_capacity_lbs (float): Total rated capacity of your scale in pounds
                                    (e.g., 1000 lbs if full scale = 1000 lbs at 20 mA)
    
    Returns:
        float: Corrected weight in pounds
    """
    # Step 1: Convert mA to raw weight (linear 4–20 mA → 0 to full scale)
    if mA < 4.0 or mA > 20.0:
        raise ValueError("mA must be between 4.0 and 20.0")
    
    raw_weight = scale_capacity_lbs * (mA - 4.0) / 16.0

    # Step 2: Convert tilt angles to radians
    theta_x = math.radians(tilt_x_deg)
    theta_y = math.radians(tilt_y_deg)

    # Step 3: Compute gravity projection factor
    # True weight = measured_weight / (cos(x) * cos(y))
    cos_correction = math.cos(theta_x) * math.cos(theta_y)

    if cos_correction < 0.7:  # ~±45° limit
        print(f"Warning: High tilt! cos_factor = {cos_correction:.3f} (accuracy reduced)")

    if cos_correction == 0:
        raise ValueError("Tilt too extreme: cos(θx)*cos(θy) = 0")

    # Step 4: Apply tilt correction
    true_weight = raw_weight / cos_correction

    return true_weight