import time
from pymodbus.client import ModbusTcpClient

# Watchdog configuration (check your device documentation)
WATCHDOG_REGISTER = 100
WATCHDOG_VALUE = 0xAAAA  # Common value, but specific to your device
WATCHDOG_INTERVAL = 2  # Time in seconds between resets

# Create a Modbus TCP client instance
client = ModbusTcpClient("your_server_ip", port=502)

try:
    # Connect to the Modbus server
    if not client.connect():
        print("Failed to connect to Modbus server.")
        exit()

    print("Connected to Modbus server. Starting watchdog reset loop...")

    while True:
        # Write the watchdog value to the holding register
        result = client.write_register(WATCHDOG_REGISTER, WATCHDOG_VALUE, slave=1)

        # Check for successful write
        if result.isError():
            print(f"Error resetting watchdog: {result}")
        else:
            print(f"Successfully reset watchdog at register {WATCHDOG_REGISTER}")

        # Wait for the next reset interval
        time.sleep(WATCHDOG_INTERVAL)

except KeyboardInterrupt:
    print("\nWatchdog reset stopped by user.")

finally:
    # Close the client connection
    client.close()
    print("Modbus connection closed.")




//11-21-25









            grid = QGridLayout()
        grid.addWidget(self.feed1_lbl, 0,0)
        grid.addWidget(self.weight_lbl, 2,0,alignment= Qt.AlignmentFlag.AlignRight)
        grid.addWidget(self.sm_lbl, 2,1,alignment= Qt.AlignmentFlag.AlignRight)
        grid.addWidget(self.lm_lbl, 2,2,alignment= Qt.AlignmentFlag.AlignLeft)
        grid.addWidget(self.RFID_lbl, 2,3,alignment= Qt.AlignmentFlag.AlignLeft)
        grid.addWidget(self.addModule_btn, 1,4, alignment= Qt.AlignmentFlag.AlignRight)




class MainWindow(QWidget):
    def __init__(self, *args, **kwargs):
        super().__init__(*args, **kwargs)

        self.setWindowTitle('My Wish List')
        self.setWindowIcon(QIcon('./assets/wishlist.png'))
        self.setGeometry(100, 100, 400, 100)

        layout = QGridLayout(self)
        self.setLayout(layout)

        self.list_widget = QListWidget(self)
        self.list_widget.addItems(['Learn Python', 'Master PyQt'])
        layout.addWidget(self.list_widget, 0, 0, 4, 1)

        # create buttons
        add_button = QPushButton('Add')
        add_button.clicked.connect(self.add)

        insert_button = QPushButton('Insert')
        insert_button.clicked.connect(self.insert)

        remove_button = QPushButton('Remove')
        remove_button.clicked.connect(self.remove)

        clear_button = QPushButton('Clear')
        clear_button.clicked.connect(self.clear)

        layout.addWidget(add_button, 0, 1)
        layout.addWidget(insert_button, 1, 1)
        layout.addWidget(remove_button, 2, 1)
        layout.addWidget(clear_button, 3, 1)

        # show the window
        self.show()

    def add(self):
        text, ok = QInputDialog.getText(self, 'Add a New Wish', 'New Wish:')
        if ok and text:
            self.list_widget.addItem(text)

    def insert(self):
        text, ok = QInputDialog.getText(self, 'Insert a New Wish', 'New Wish:')
        if ok and text:
            current_row = self.list_widget.currentRow()
            self.list_widget.insertItem(current_row+1, text)

    def remove(self):
        current_row = self.list_widget.currentRow()
        if current_row >= 0:
            current_item = self.list_widget.takeItem(current_row)
            del current_item

    def clear(self):
        self.list_widget.clear()


if __name__ == '__main__':
    app = QApplication(sys.argv)
    window = MainWindow()
    sys.exit(app.exec())
